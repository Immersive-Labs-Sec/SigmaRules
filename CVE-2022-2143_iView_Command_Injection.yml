title: CVE-2022-2143 iView Command Injection (NetworkServlet)
status: stable
description: This SIGMA rule file is capable of detecting potential iView Command Injection attacks. This attack targets the "/NetworkServlet" endpoint. Attackers will typically upload a .JSP web shell to gain remote code execution on the Tomcat server.
author: Immersive Labs - Nikolas Cemerikic
references:
    - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-2143
    - https://www.cisa.gov/uscert/ics/advisories/icsa-22-179-03
    - https://attackerkb.com/topics/XYFOEYsgKa/cve-2022-2143
date: 22/07/2022
logsource:
   category: webserver
detection:
   paramaterEndpoint:
       cs-method: 'POST'
       sc-status: '200'
       c-uri|contains: '/iView3/'
   fileExtension:
     c-uri|contains: 
      - '.jsp'
   condition: paramaterEndpoint AND fileExtension
falsepositives:
   - Unlikely
level: Critical
tags:
   - attack.persistence
   - attack.t1190